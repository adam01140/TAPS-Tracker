<!DOCTYPE html>
<!-- saved from url=(0027)https://defundtaps.web.app/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="./defundtaps.web.app_files/style.css">

    <link href="./defundtaps.web.app_files/css" rel="stylesheet">
    <link href="./defundtaps.web.app_files/css(1)" rel="stylesheet">
	

	<link rel="stylesheet" href="./defundtaps.web.app_files/normalize.min.css">

<style>
        /* Make dropdown text bold */
        select option {
            font-weight: bold;
        }

        /* Make placeholder text in textboxes bold */
        ::placeholder {
            font-weight: bold;
        }

        /* Adjust input elements styling */
        #predictionTime, #timeOccurred {
            font-size: 40px; /* Larger font size for better readability */
            padding: 20px; /* Increased padding for easier interaction */
            background-color: #ffffff; /* Light blue background for consistency with the theme */
            color: #6bc1fa; /* Dark text for better contrast */
            border: 3px solid #000000; /* Dark blue border */
            border-radius: 40px; /* Rounded corners for a smoother look */
            width: 30%; /* Full width to match other form elements */
            height: 25px;
            font-weight: bold;
            display: block; /* Ensure it takes up the full width of its container */
            text-align: center; /* Center text horizontally */
        }

        /* Adjust prediction location styling */
        #predictionLocation {
            font-weight: bold;
            font-size: 25px; /* Match font size with other inputs */
            padding: 12px 20px; /* Uniform padding */
            background-color: #ffffff; /* A lighter shade of blue for the background */
            color: #333; /* Dark text for contrast */
            height: 60px;
            border: 3px solid #000000; /* Dark blue border to stand out */
            border-radius: 40px; /* Rounded corners */
            width: 50%; /* Ensure it's full-width */
            text-align: center; /* Center text horizontally */
            display: block;
        }

        .predict-button {
            font-size: 15px; /* Smaller font size */
            padding: 10px;
        }

        body, html {
            overflow-x: visible; /* Allow horizontal overflow */
        }

        #report2 {
            font-size: 18px; /* Match font size with other inputs */
            padding: 12px 20px; /* Uniform padding */
            background-color: #ffffff; /* A lighter shade of blue for the background */
            /* Ensure it's full-width */
            box-sizing: border-box; /* Include padding and border in the width */
            margin: 10px 0; /* Margin for spacing */
            border: 5px solid lightblue;
            width: 80%;
            border-radius: 40px;
        }

        #timeOccurred {
            font-size: 35px; /* Increased font size */
            padding: 12px; /* Slightly larger padding */
            width: calc(100% - 0px); /* Use viewport widths to ensure it's larger than the viewport */
            box-sizing: border-box;
            border: 3px solid #000000;
            border-radius: 40px;
            display: block; /* Ensure it's not inline */
            margin: 0 auto; /* Center it within its container, though it will extend off-screen */
            text-align: center; /* Center text horizontally */
            margin-top: 20px;
        }

        .item {
            background-color: #f0f0f0; /* Light grey background */
            text-align: center;
            border-radius: 40px; /* Rounded corners */
            padding: 10px; /* Some padding inside the div */
            margin-bottom: 10px; /* Margin at the bottom to separate each item */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* Optional: adds a subtle shadow for depth */
        }
		

        input[type="text"], input[type="datetime-local"], input[type="time"], select {
            background-color: #ffffff; /* White background */
            color: #000000; /* Black text color */
            border: 3px solid #000000; /* Black border */
            text-align: center; /* Center text horizontally */
        }

        /* Make dropdown text bold */
        select option {
            font-weight: bold;
        }

        /* Make placeholder text in textboxes bold */
        ::placeholder {
            font-weight: bold;
        }

        /* Ensure both input and select elements are centered */
        #citationNumber {
		
            color: #000000; /* Black text color */
            font-size: 30px; /* Increased font size */
            border-radius: 40px; /* Rounded corners with a radius of 40px */
            border: 3px solid #000000; /* Black border to match the rest of the form */
            height: 60px;
            text-align: center; /* Center text horizontally */
            padding: 0; /* Remove default padding */
            display: block;
            margin: 10px auto; /* Center the element itself */
            width: calc(100% - 20px); /* Ensure full width with some margin */
            box-sizing: border-box;
            -webkit-appearance: none; /* Ensure appearance is consistent across devices */
            -moz-appearance: none;
            appearance: none;
            font-weight: bold; /* Make text bold */
        }

        #collegeLocation {
            color: #000000;
            font-size: 30px; /* Increased font size */
            border-radius: 40px; /* Rounded corners with a radius of 40px */
            border: 3px solid #000000; /* Black border to match the rest of the form */
            height: 60px;
            text-align: center; /* Center text horizontally */
            padding: 10px; /* Remove default padding */
            display: block;
            margin: 10px auto; /* Center the element itself */
            width: calc(100% - 20px); /* Ensure full width with some margin */
            box-sizing: border-box;
            -webkit-appearance: none; /* Ensure appearance is consistent across devices */
            -moz-appearance: none;
            appearance: none;
            font-weight: bold; /* Make text bold */
        }
		
		
		#licensePlate {
            color: #000000;
            font-size: 30px; /* Increased font size */
            border-radius: 40px; /* Rounded corners with a radius of 40px */
            border: 3px solid #000000; /* Black border to match the rest of the form */
            height: 60px;
            text-align: center; /* Center text horizontally */
            padding: 10px; /* Remove default padding */
            display: block;
            margin: 10px auto; /* Center the element itself */
            width: calc(100% - 20px); /* Ensure full width with some margin */
            box-sizing: border-box;
            -webkit-appearance: none; /* Ensure appearance is consistent across devices */
            -moz-appearance: none;
            appearance: none;
            font-weight: bold; /* Make text bold */
        }

        /* Additional styles for the select element */
        #collegeLocation {
            background-position: right 30px center; /* Adjust background position for dropdown arrow */
            background-repeat: no-repeat; /* Prevent background repetition */
            text-align-last: center; /* Center the text for the last line */
        }

        /* Ensure the option elements inherit the font-weight */
        #collegeLocation option {
            font-weight: bold;
        }

        /* Styles for input elements */
        input[type="text"], input[type="datetime-local"], input[type="time"], select {
            background-color: #ffffff; /* White background */
            border: 3px solid #000000; /* Black border */
            text-align: center; /* Center text horizontally */
            font-size: 20px; /* Increased font size */
            font-weight: bold; /* Make text bold */
        }

        /* Specific style for time inputs */
        input[type="time"] {
            color: #89CFF0; /* Light blue text color */
        }

        /* Make placeholder text bold */
        ::placeholder {
            font-weight: bold;
        }

        /* Adjust submit button styling */
        #submitCitationButton {
            font-size: 20px; /* Increased font size */
            padding: 1px;
        }

        body {
            /* Gradient background */
            background: linear-gradient(135deg, #89CFF0, #4682B4);
            /* Fallback color for browsers that don't support gradients */
            background-color: #89CFF0;
            /* Ensure the background covers the entire page */
            min-height: 100vh;
            /* Font settings for body text */
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #predictionSection {
            display: flex;
            flex-direction: column;
            align-items: center;
			color: #000000
        }

        #wherewhen {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px; /* Add some spacing between the select and input elements */
        }

        /* Media query for mobile devices */
        @media (max-width: 1000px) {
		
		
		#predictionTime, #timeOccurred {
            font-size: 40px; /* Larger font size for better readability */
            padding: 20px; /* Increased padding for easier interaction */
            background-color: #ffffff; /* Light blue background for consistency with the theme */
            color: #6bc1fa; /* Dark text for better contrast */
            border: 3px solid #000000; /* Dark blue border */
            border-radius: 40px; /* Rounded corners for a smoother look */
            width: 30%; /* Full width to match other form elements */
            height: 50px;
            font-weight: bold;
            display: block; /* Ensure it takes up the full width of its container */
            text-align: center; /* Center text horizontally */
        }
		
		
            select, input[type="text"], input[type="datetime-local"], input[type="time"] {
                width: calc(100% - 40px); /* Adjust width for mobile devices */
                font-size: 18px; /* Adjust font size for better readability */
                height: 90px; /* Adjust height for better display */
            }

            #report2 {
                width: 90%; /* Adjust width for mobile devices */
            }

            .predict-button {
				width: 700px;
				margin-top: 5px;
                font-size: 20px;
				font-weight: bold;
            }
			
			.toggleSightingsButton {
				width: 30px;
				margin-top: 5px;
                font-size: 20px;
				font-weight: bold;
            }
        }

        button {
			width: 70px;
            margin-top: 0px;
            height: 80px;
            font-size: 20px;
            cursor: pointer; /* Changes cursor to pointer when hovering over the button */
            border: none; /* Removes border */
            background-color: #007bff; /* Example button color, change as needed */
            color: white; /* Text color */
            border-radius: 40px; /* Adds rounded corners to the button */
            width: 200px; /* Adjust width as needed */
            display: block; /* Makes the button block level for width control */
            margin: 0 auto; /* Centers the button */
        }
		
		
	



    </style>
	<script src="./defundtaps.web.app_files/chart.js.download"></script>
    <script src="./defundtaps.web.app_files/firebase-app-compat.js.download"></script>
<script src="./defundtaps.web.app_files/firebase-auth-compat.js.download"></script>
<script src="./defundtaps.web.app_files/firebase-firestore-compat.js.download"></script>
	

    

  <script type="text/javascript" charset="UTF-8" src="./defundtaps.web.app_files/common.js.download"></script><script type="text/javascript" charset="UTF-8" src="./defundtaps.web.app_files/util.js.download"></script><script type="text/javascript" charset="UTF-8" src="./defundtaps.web.app_files/map.js.download"></script></head>

  <body>
    <div class="header center">
      <div class="half_width">
	  <br>
        <p> </p>
		<br>
      </div>
    </div>

    <div class="content gradient">
      <!-- <h1 class="title">FORECAST</h1> -->
		
        <div class="inner-content big">
      
		  <img src="./defundtaps.web.app_files/logo.png" width="300" height="200" alt="logo taps ucsc tracker">
			
			
			
			<div id="report2">
			<center>
			

			<center>
			
			<h1><b><u> Report a Citation</u> </b></h1>
			<br>
			<input type="text" id="licensePlate" placeholder="License Plate">
 <br>
			<input type="text" id="citationNumber" placeholder="Citation Number (optional)">
			
		<select id="collegeLocation" style="display: none;">
		<option value="COLLEGE NINE">COLLEGE NINE</option>
    <option value="153 CROWN - MERRILL APARTMENTS">153 CROWN - MERRILL APARTMENTS</option><option value="154 CROWN - MERRILL APARTMENTS">154 CROWN - MERRILL APARTMENTS</option><option value="111B CROWN COLLEGE CIRCLE">111B CROWN COLLEGE CIRCLE</option><option value="111A CROWN COLLEGE CIRCLE">111A CROWN COLLEGE CIRCLE</option><option value="MERRILL COLLEGE APTS">MERRILL COLLEGE APTS</option><option value="CROWN SERVICE ROAD">CROWN SERVICE ROAD</option><option value="FARM CASFS">FARM CASFS</option><option value="168 AGROECOLOGY">168 AGROECOLOGY</option><option value="169 AGROECOLOGY">169 AGROECOLOGY</option><option value="170 HAY BARN">170 HAY BARN</option><option value="105 UNIVERSITY POLICE">105 UNIVERSITY POLICE</option><option value="116 CAMPUS FACILITIES">116 CAMPUS FACILITIES</option><option value="170 HAY BARN">170 HAY BARN</option><option value="Cowell Lot 106">Cowell Lot 106</option><option value="Cowell Lot 107">Cowell Lot 107</option><option value="Cowell Lot 108">Cowell Lot 108</option><option value="Cowell Circle">Cowell Circle</option><option value="Stevenson Lot 109">Stevenson Lot 109</option><option value="Stevenson Lot 110">Stevenson Lot 110</option><option value="Stevenson Circle">Stevenson Circle</option><option value="Gym Lot 103">Gym Lot 103</option><option value="East Remote">East Remote</option><option value="127 WEST REMOTE">127 WEST REMOTE</option><option value="The Village Lot 168">The Village Lot 168</option><option value="Baytree Bookstore Lot 102">Baytree Bookstore Lot 102</option><option value="McHenry Library Lot 101">McHenry Library Lot 101</option><option value="McHenry Library Lot 120">McHenry Library Lot 120</option><option value="126 PERFORMING ARTS">126 PERFORMING ARTS</option><option value="Merrill Lot 119">Merrill Lot 119</option><option value="Merrill Circle">Merrill Circle</option><option value="Porter Lot 124">Porter Lot 124</option><option value="Porter Lot 125">Porter Lot 125</option><option value="146 RACHEL CARSON COLLEGE">146 RACHEL CARSON COLLEGE</option><option value="Rachel Carson Lot 160">Rachel Carson Lot 160</option><option value="Rachel Carson Lot 161">Rachel Carson Lot 161</option><option value="Rachel Carson Lot 162">Rachel Carson Lot 162</option><option value="Family Housing Lot 129">Family Housing Lot 129</option><option value="Family Housing Lot 130">Family Housing Lot 130</option><option value="Family Housing Lot 131">Family Housing Lot 131</option><option value="Family Housing Lot 132">Family Housing Lot 132</option><option value="Family Housing Lot 133">Family Housing Lot 133</option><option value="Family Housing Lot 134">Family Housing Lot 134</option><option value="Family Housing Lot 135">Family Housing Lot 135</option><option value="Family Housing Lot 136">Family Housing Lot 136</option><option value="Kresge Lot 142">Kresge Lot 142</option><option value="Kresge Lot 143">Kresge Lot 143</option><option value="Kresge Lot 145">Kresge Lot 145</option><option value="Kresge Lot 147">Kresge Lot 147</option><option value="West Parking Garage">West Parking Garage</option><option value="West Charging Station">West Charging Station</option><option value="Jack Baskin Lot 157">Jack Baskin Lot 157</option><option value="Jack Baskin Lot 138">Jack Baskin Lot 138</option><option value="Thimann Lot 138">Thimann Lot 138</option><option value="Redwood Grove Lot 158">Redwood Grove Lot 158</option><option value="Redwood Grove Lot 159">Redwood Grove Lot 159</option><option value="Oakes Circle">Oakes Circle</option><option value="College 10 Lot 114">College 10 Lot 114</option><option value="164 JOHN R. LEWIS COLLEGE">164 JOHN R. LEWIS COLLEGE</option><option value="College 10 Lot 165">College 10 Lot 165</option><option value="College 10 Lot 165">College 10 Lot 165</option><option value="College 10 Lot 167">College 10 Lot 167</option><option value="College 9 Lot 166">College 9 Lot 166</option><option value="153 CROWN - MERRILL APARTMENTS">153 CROWN - MERRILL APARTMENTS</option><option value="154 CROWN - MERRILL APARTMENTS">154 CROWN - MERRILL APARTMENTS</option><option value="111B CROWN COLLEGE CIRCLE">111B CROWN COLLEGE CIRCLE</option><option value="111A CROWN COLLEGE CIRCLE">111A CROWN COLLEGE CIRCLE</option><option value="MERRILL COLLEGE APTS">MERRILL COLLEGE APTS</option><option value="CROWN SERVICE ROAD">CROWN SERVICE ROAD</option><option value="FARM CASFS">FARM CASFS</option><option value="168 AGROECOLOGY">168 AGROECOLOGY</option><option value="169 AGROECOLOGY">169 AGROECOLOGY</option><option value="170 HAY BARN">170 HAY BARN</option><option value="105 UNIVERSITY POLICE">105 UNIVERSITY POLICE</option><option value="116 CAMPUS FACILITIES">116 CAMPUS FACILITIES</option><option value="170 HAY BARN">170 HAY BARN</option><option value="Cowell Lot 106">Cowell Lot 106</option><option value="Cowell Lot 107">Cowell Lot 107</option><option value="Cowell Lot 108">Cowell Lot 108</option><option value="Cowell Circle">Cowell Circle</option><option value="Stevenson Lot 109">Stevenson Lot 109</option><option value="Stevenson Lot 110">Stevenson Lot 110</option><option value="Stevenson Circle">Stevenson Circle</option><option value="Gym Lot 103">Gym Lot 103</option><option value="East Remote">East Remote</option><option value="127 WEST REMOTE">127 WEST REMOTE</option><option value="The Village Lot 168">The Village Lot 168</option><option value="Baytree Bookstore Lot 102">Baytree Bookstore Lot 102</option><option value="McHenry Library Lot 101">McHenry Library Lot 101</option><option value="McHenry Library Lot 120">McHenry Library Lot 120</option><option value="126 PERFORMING ARTS">126 PERFORMING ARTS</option><option value="Merrill Lot 119">Merrill Lot 119</option><option value="Merrill Circle">Merrill Circle</option><option value="Porter Lot 124">Porter Lot 124</option><option value="Porter Lot 125">Porter Lot 125</option><option value="146 RACHEL CARSON COLLEGE">146 RACHEL CARSON COLLEGE</option><option value="Rachel Carson Lot 160">Rachel Carson Lot 160</option><option value="Rachel Carson Lot 161">Rachel Carson Lot 161</option><option value="Rachel Carson Lot 162">Rachel Carson Lot 162</option><option value="Family Housing Lot 129">Family Housing Lot 129</option><option value="Family Housing Lot 130">Family Housing Lot 130</option><option value="Family Housing Lot 131">Family Housing Lot 131</option><option value="Family Housing Lot 132">Family Housing Lot 132</option><option value="Family Housing Lot 133">Family Housing Lot 133</option><option value="Family Housing Lot 134">Family Housing Lot 134</option><option value="Family Housing Lot 135">Family Housing Lot 135</option><option value="Family Housing Lot 136">Family Housing Lot 136</option><option value="Kresge Lot 142">Kresge Lot 142</option><option value="Kresge Lot 143">Kresge Lot 143</option><option value="Kresge Lot 145">Kresge Lot 145</option><option value="Kresge Lot 147">Kresge Lot 147</option><option value="West Parking Garage">West Parking Garage</option><option value="West Charging Station">West Charging Station</option><option value="Jack Baskin Lot 157">Jack Baskin Lot 157</option><option value="Jack Baskin Lot 138">Jack Baskin Lot 138</option><option value="Thimann Lot 138">Thimann Lot 138</option><option value="Redwood Grove Lot 158">Redwood Grove Lot 158</option><option value="Redwood Grove Lot 159">Redwood Grove Lot 159</option><option value="Oakes Circle">Oakes Circle</option><option value="College 10 Lot 114">College 10 Lot 114</option><option value="164 JOHN R. LEWIS COLLEGE">164 JOHN R. LEWIS COLLEGE</option><option value="College 10 Lot 165">College 10 Lot 165</option><option value="College 10 Lot 165">College 10 Lot 165</option><option value="College 10 Lot 167">College 10 Lot 167</option><option value="College 9 Lot 166">College 9 Lot 166</option></select>
	
	
			<input type="datetime-local" id="timeOccurred" style="display: none;">
			<br>
	
	<div id="map" class="map2" style="display: none;"><div style="height: 100%; width: 100%;"><div style="overflow: hidden;"></div></div></div>
	<h2>
	
	<button id="submitCitationButton" onclick="submitCitation()"><h3>Submit Citation</h3></button>
<br>

	<b>
   
    
	</b>
   

</h2></center></center></div>











<br><br>

			
			<!-- Add this section to your HTML where you want the prediction interface to appear -->
<div class="map" id="predictionSection">

<center>
<br>
  <h1><b><u>Will You Get A Ticket?</u></b></h1>

  
  

  <br>
  <br>
  <center>

  
  <div id="wherewhen" style="display:flex">
  
  <select id="predictionLocation" style="display:flex"><option value="COLLEGE NINE">COLLEGE NINE</option><option value="167 COLLEGE NINE">167 COLLEGE NINE</option><option value="103A EAST FIELD HOUSE">103A EAST FIELD HOUSE</option><option value="163 COWELL PROVOST">163 COWELL PROVOST</option><option value="107 COWELL - STEVENSON">107 COWELL - STEVENSON</option><option value="125 PORTER COLLEGE">125 PORTER COLLEGE</option><option value="124 PORTER COLLEGE">124 PORTER COLLEGE</option><option value="154 CROWN - MERRILL APARTMENTS">154 CROWN - MERRILL APARTMENTS</option><option value="152 CROWN - MERRILL APARTMENTS">152 CROWN - MERRILL APARTMENTS</option><option value="OAKES FIELD SERVICE ROAD">OAKES FIELD SERVICE ROAD</option><option value="150A NORTH PERIMETER">150A NORTH PERIMETER</option><option value="139B COMMUNICATIONS">139B COMMUNICATIONS</option><option value="113 THIMANN LAB">113 THIMANN LAB</option><option value="168 AGROECOLOGY">168 AGROECOLOGY</option><option value="120B UPPER MCHENRY LIBRARY - RESTRIC">120B UPPER MCHENRY LIBRARY - RESTRIC</option><option value="126 PERFORMING ARTS">126 PERFORMING ARTS</option><option value="108 STEVENSON SERVICE ROAD">108 STEVENSON SERVICE ROAD</option><option value="156 FIRE HOUSE">156 FIRE HOUSE</option><option value="111A CROWN COLLEGE PIT">111A CROWN COLLEGE PIT</option><option value="162 OAKES COLLEGE">162 OAKES COLLEGE</option><option value="111B CROWN COLLEGE CIRCLE">111B CROWN COLLEGE CIRCLE</option><option value="146 RACHEL CARSON COLLEGE">146 RACHEL CARSON COLLEGE</option><option value="139A ENGINEERING II">139A ENGINEERING II</option><option value="165 JOHN R. LEWIS COLLEGE">165 JOHN R. LEWIS COLLEGE</option><option value="109 STEVENSON COLLEGE">109 STEVENSON COLLEGE</option><option value="110 STEVENSON COLLEGE">110 STEVENSON COLLEGE</option><option value="158 REDWOOD GROVE APARTMENTS">158 REDWOOD GROVE APARTMENTS</option><option value="159 REDWOOD GROVE APARTMENTS">159 REDWOOD GROVE APARTMENTS</option><option value="120A LOWER MCHENRY LIBRARY">120A LOWER MCHENRY LIBRARY</option><option value="ACADEMIC RESOURCE CENTER">ACADEMIC RESOURCE CENTER</option><option value="112 CORE WEST STRUCTURE">112 CORE WEST STRUCTURE</option><option value="147 KRESGE COLLEGE">147 KRESGE COLLEGE</option><option value="STEINHART WAY">STEINHART WAY</option><option value="102 QUARRY PLAZA">102 QUARRY PLAZA</option><option value="FARM ROAD">FARM ROAD</option><option value="164 JOHN R. LEWIS COLLEGE">164 JOHN R. LEWIS COLLEGE</option><option value="166 COLLEGE NINE">166 COLLEGE NINE</option><option value="160 OAKES COLLEGE">160 OAKES COLLEGE</option><option value="119 MERRILL COLLEGE">119 MERRILL COLLEGE</option><option value="STEVENSON SERVICE ROAD">STEVENSON SERVICE ROAD</option><option value="140 FOUNDRY">140 FOUNDRY</option><option value="104 EAST REMOTE">104 EAST REMOTE</option><option value="128 HEALTH CENTER">128 HEALTH CENTER</option><option value="LOOKOUT">LOOKOUT</option><option value="205 C.S.C. - COASTAL BIOLOGY BLDG">205 C.S.C. - COASTAL BIOLOGY BLDG</option><option value="202 C.S.C. - SOUTH SERVICE AREA">202 C.S.C. - SOUTH SERVICE AREA</option><option value="301 2300 DELAWARE - SOUTH LOT">301 2300 DELAWARE - SOUTH LOT</option><option value="VILLAGE ROAD">VILLAGE ROAD</option><option value="COOLIDGE DRIVE">COOLIDGE DRIVE</option><option value="161 OAKES COLLEGE">161 OAKES COLLEGE</option><option value="127 WEST REMOTE">127 WEST REMOTE</option><option value="MERRILL COLLEGE">MERRILL COLLEGE</option><option value="138 BASKIN ENGINEERING">138 BASKIN ENGINEERING</option><option value="149 HELLER EXTENSION">149 HELLER EXTENSION</option><option value="116 CAMPUS FACILITIES">116 CAMPUS FACILITIES</option><option value="115 CARRIAGE HOUSE">115 CARRIAGE HOUSE</option><option value="PORTER COLLEGE">PORTER COLLEGE</option><option value="165 COLLEGE TEN">165 COLLEGE TEN</option><option value="KRESGE COLLEGE">KRESGE COLLEGE</option><option value="EARTH AND MARINE SCIENCES BUILDING">EARTH AND MARINE SCIENCES BUILDING</option><option value="101 HAHN STUDENT SERVICES">101 HAHN STUDENT SERVICES</option><option value="134 FAMILY STUDENT HOUSING - 600 LOO">134 FAMILY STUDENT HOUSING - 600 LOO</option><option value="131 FAMILY STUDENT HOUSING - 300 LOO">131 FAMILY STUDENT HOUSING - 300 LOO</option><option value="135 FAMILY STUDENT HOUSING - 700 LOO">135 FAMILY STUDENT HOUSING - 700 LOO</option><option value="FAMILY STUDENT HOUSING">FAMILY STUDENT HOUSING</option><option value="RED HILL ROAD">RED HILL ROAD</option><option value="106 COWELL COLLEGE">106 COWELL COLLEGE</option><option value="121 BIOMED - SCIENCE LIBRARY">121 BIOMED - SCIENCE LIBRARY</option><option value="BASKIN VISUAL ARTS">BASKIN VISUAL ARTS</option><option value="143 KRESGE COLLEGE">143 KRESGE COLLEGE</option><option value="150B NORTH PERIMETER">150B NORTH PERIMETER</option><option value="WEST FIELD HOUSE - RACHEL CARSON COL">WEST FIELD HOUSE - RACHEL CARSON COL</option><option value="141 KERR HALL">141 KERR HALL</option><option value="THEATER ARTS CENTER">THEATER ARTS CENTER</option><option value="133 FAMILY STUDENT HOUSING - 500 LOO">133 FAMILY STUDENT HOUSING - 500 LOO</option><option value="130 FAMILY STUDENT HOUSING - 200 LOO">130 FAMILY STUDENT HOUSING - 200 LOO</option><option value="136 FAMILY STUDENT HOUSING - 800 LOO">136 FAMILY STUDENT HOUSING - 800 LOO</option><option value="RACHEL CARSON COLLEGE">RACHEL CARSON COLLEGE</option><option value="FARM CASFS">FARM CASFS</option><option value="WEST SIDE RESEARCH PARK">WEST SIDE RESEARCH PARK</option><option value="169 THE VILLAGE">169 THE VILLAGE</option><option value="145 KRESGE COLLEGE">145 KRESGE COLLEGE</option><option value="OAKES COLLEGE">OAKES COLLEGE</option><option value="126  126 PERFORMING ARTS">126  126 PERFORMING ARTS</option><option value="HAGAR DRIVE">HAGAR DRIVE</option><option value="206 C.S.C. - SURGE PARKING">206 C.S.C. - SURGE PARKING</option><option value="CROWN SERVICE ROAD">CROWN SERVICE ROAD</option><option value="201 C.S.C. - SEYMOUR CENTER">201 C.S.C. - SEYMOUR CENTER</option><option value="155 CROWN - MERRILL APARTMENTS">155 CROWN - MERRILL APARTMENTS</option><option value="MERRILL COLLEGE APTS">MERRILL COLLEGE APTS</option><option value="170 HAY BARN">170 HAY BARN</option><option value="114 SOCIAL SCIENCES">114 SOCIAL SCIENCES</option><option value="COWELL COLLEGE">COWELL COLLEGE</option><option value="153 CROWN - MERRILL APARTMENTS">153 CROWN - MERRILL APARTMENTS</option><option value="CROWN APARTMENTS">CROWN APARTMENTS</option><option value="157 GRADUATE STUDENT APARTMENTS">157 GRADUATE STUDENT APARTMENTS</option><option value="150A NORTH PERIMITER">150A NORTH PERIMITER</option><option value="111A">111A</option><option value="114 JOHN R. LEWIS COLLEGE">114 JOHN R. LEWIS COLLEGE</option><option value="VILLAGE">VILLAGE</option><option value="THIMANN LABS">THIMANN LABS</option><option value="144 OAKES COLLEGE">144 OAKES COLLEGE</option><option value="COWELL COLLEGE INFILL APTS">COWELL COLLEGE INFILL APTS</option><option value="164 COLLEGE TEN">164 COLLEGE TEN</option><option value="203 C.S.C. - CENTER FOR OCEAN HEALTH">203 C.S.C. - CENTER FOR OCEAN HEALTH</option><option value="CROWN COLLEGE">CROWN COLLEGE</option><option value="LEONARDO LANE">LEONARDO LANE</option><option value="103B  OPERS - RESTRICTED">103B  OPERS - RESTRICTED</option><option value="150B NORTH PERIMITER">150B NORTH PERIMITER</option><option value="ENGINEERING LIBRARY">ENGINEERING LIBRARY</option></select>

  <input type="time" id="predictionTime" required="">
  </div>
  <br>
   


<div id="predictionVariables" class="prediction-variables"></div>

<div id="predictionResult"> <br><h1> Your chances of getting a ticket are <b>0.00%</b></h1><ul></ul></div>

<canvas id="hourlyCitationChart" width="1076" height="645" style="display: block; box-sizing: border-box; height: 516px; width: 861px;"></canvas>

<button class="predict-button" onclick="calculatePrediction()"><h2><b>View Results</b></h2><br><br><br></button>
 


<br>





  
</center></center></div>






<br><br><br><br>


<div class="map">
<br><br>
<div id="map" class="map" style="display:none"></div>


<h1><center> Recent Citations: </center></h1>


<!-- <div id="forecastMap" class="map"></div>	-->

<center>
<br>
<button id="toggleSightingsButton" onclick="toggleSightingsDisplay()">Show More</button>
<br>

<center>	
<div id="sightingsContainer"><div class="item">
            <center>
            <div class="sighting-location">COLLEGE NINE</div>
            <div>6/6/2024</div>
            <div>11:47am</div>
            <div>Citation #: Unavailable</div>
        </center></div><div class="item">
            <center>
            <div class="sighting-location">COLLEGE NINE</div>
            <div>9/9/2023</div>
            <div>4:03pm</div>
            <div>Citation #: 377128241</div>
        </center></div><div class="item">
            <center>
            <div class="sighting-location">167 COLLEGE NINE</div>
            <div>9/9/2023</div>
            <div>3:58pm</div>
            <div>Citation #: 377128240</div>
        </center></div><div class="item">
            <center>
            <div class="sighting-location">103A EAST FIELD HOUSE</div>
            <div>9/9/2023</div>
            <div>3:38pm</div>
            <div>Citation #: 377128238</div>
        </center></div><div class="item">
            <center>
            <div class="sighting-location">103A EAST FIELD HOUSE</div>
            <div>9/9/2023</div>
            <div>3:36pm</div>
            <div>Citation #: 377128237</div>
        </center></div></div>
<br>
</center></center></div>
</div>
</div>
	
	


	<script>
	
	
	const firebaseConfig = {
  apiKey: "AIzaSyAgYdoZnSv5ekxngv_ue61aFZUGcRlphok",
  authDomain: "defundtaps.firebaseapp.com",
  projectId: "defundtaps",
  storageBucket: "defundtaps.appspot.com",
  messagingSenderId: "456064481827",
  appId: "1:456064481827:web:4a4b37035fbfbd534ccf96",
  measurementId: "G-4ZX480FN46"
};

firebase.initializeApp(firebaseConfig);

async function init() {
    const userCredential = await firebase.auth().signInAnonymously();
}
init();

var db = firebase.firestore();


firebase.auth().signInAnonymously()
  .then(() => {
    // Authentication succeeded
    console.log("Signed in anonymously");
    fetchSightings(); // Now it's safe to fetch data
  })
  .catch((error) => {
    console.error("Error signing in anonymously:", error);
  });
  
  
  
let allSightings = [];
let showingAll = false;
var days = [
    "Sunday",
    "Monday",
    "Tuesday",
    "Wednesday",
    "Thursday",
    "Friday",
    "Saturday",
];




window.addEventListener('DOMContentLoaded', (event) => {
    const now = new Date();

    // Formatting for date-time input
    const formattedDate = now.getFullYear() + '-' +
        (now.getMonth() + 1).toString().padStart(2, '0') + '-' +
        now.getDate().toString().padStart(2, '0');

    const formattedTime = now.getHours().toString().padStart(2, '0') + ':' +
        now.getMinutes().toString().padStart(2, '0');

    // Existing code to set the date
    document.getElementById('timeOccurred').value = formattedDate + 'T' + formattedTime;

    // New code to set the time
    document.getElementById('predictionTime').value = formattedTime;
});



window.addEventListener('DOMContentLoaded', (event) => {
    const now = new Date();

    const formattedDateTime = now.getFullYear() + '-' +
        (now.getMonth() + 1).toString().padStart(2, '0') + '-' +
        now.getDate().toString().padStart(2, '0') + 'T' +
        now.getHours().toString().padStart(2, '0') + ':' +
        now.getMinutes().toString().padStart(2, '0');

    document.getElementById('timeOccurred').value = formattedDateTime;

    // ...rest of your code
});



const now = new Date();
let currentDay = days[now.getDay()];
//document.getElementById(currentDay).style.backgroundColor = "#3797F0";
//document.getElementById("now_show").innerHTML=currentDay;
var map;
let dropped = false;
var forecastMap;
var markers = [];

let map2;

        function initMap2() {
            map2 = new google.maps.Map(document.getElementById('map2'), {
                center: { lat: 36.9914, lng: -122.0609 },
                zoom: 14
            });
            fetchRecentCitations();
        }
		
		
var colleges = [


	{name: "153 CROWN - MERRILL APARTMENTS", lat: 7.002128, lng: -122.053512 },
	{name: "154 CROWN - MERRILL APARTMENTS", lat: 37.002163, lng: -122.054817 },
	{name: "111B CROWN COLLEGE CIRCLE", lat: 37.001089, lng: -122.054401 },
	{name: "111A CROWN COLLEGE CIRCLE", lat: 37.000628, lng: -122.054770 },
	{ name: "MERRILL COLLEGE APTS", lat: 36.999681, lng: -122.051747 },
	{ name: "CROWN SERVICE ROAD", lat: 37.000602, lng: -122.054672 },
	{ name: "FARM CASFS", lat: 36.985346, lng: -122.055503 },
	{ name: "168 AGROECOLOGY", lat: 36.985335, lng: -122.055504},
	{ name: "169 AGROECOLOGY", lat: 36.986809, lng: -122.055375 },
	{name: "170 HAY BARN", lat: 36.981037, lng: -122.054451 },
	{name: "105 UNIVERSITY POLICE", lat: 36.979614, lng: -122.052061 },
	{name: "116 CAMPUS FACILITIES", lat: 36.980995, lng: -122.051875 },
	
	
	{name: "170 HAY BARN", lat: 36.981037, lng: -122.054451 },
    { name: "Cowell Lot 106", lat: 36.99828, lng: -122.053877 },
    { name: "Cowell Lot 107", lat: 36.997918, lng: -122.053193 },
    { name: "Cowell Lot 108", lat: 36.997613, lng: -122.052994 },
    { name: "Cowell Circle", lat: 36.997705, lng: -122.053444 },

    { name: "Stevenson Lot 109", lat: 36.998219, lng: -122.052683 },
    { name: "Stevenson Lot 110", lat: 36.99822, lng: -122.051618 },
    { name: "Stevenson Circle", lat: 36.99822, lng: -122.051618 },

    { name: "Gym Lot 103", lat: 36.99498, lng: -122.055254 },
    { name: "East Remote", lat: 36.991035, lng: -122.053164 },
    { name: "127 WEST REMOTE", lat: 36.98855, lng: -122.065901 },
    { name: "The Village Lot 168", lat: 36.985349, lng: -122.055505 },
    { name: "Baytree Bookstore Lot 102", lat: 36.997399, lng: -122.055595 },

    { name: "McHenry Library Lot 101", lat: 36.995104, lng: -122.057185 },
    { name: "McHenry Library Lot 120", lat: 36.996277, lng: -122.059167 },

    { name: "126 PERFORMING ARTS", lat: 36.993388, lng: -122.061556 },

    { name: "Merrill Lot 119", lat: 36.999681, lng: -122.051747 },
    { name: "Merrill Circle", lat: 6.999544, lng: -122.052738 },

    { name: "Porter Lot 124", lat: 36.99437, lng: -122.06415 },
    { name: "Porter Lot 125", lat: 36.9938, lng: -122.064738 },

    { name: "146 RACHEL CARSON COLLEGE", lat: 36.992282, lng: -122.064506 },
    { name: "Rachel Carson Lot 160", lat: 36.990212, lng: -122.06478 },
    { name: "Rachel Carson Lot 161", lat: 36.990005, lng: -122.064874 },
    { name: "Rachel Carson Lot 162", lat: 36.990049, lng: -122.065698 },

    { name: "Family Housing Lot 129", lat: 36.991003, lng: -122.067091 },
    { name: "Family Housing Lot 130", lat: 36.990828, lng: -122.067578 },
    { name: "Family Housing Lot 131", lat: 36.991186, lng: -122.067705 },
    { name: "Family Housing Lot 132", lat: 36.990828, lng: -122.068376 },
    { name: "Family Housing Lot 133", lat: 36.991198, lng: -122.068438 },
    { name: "Family Housing Lot 134", lat: 36.990586, lng: -122.068785 },
    { name: "Family Housing Lot 135", lat: 36.991865, lng: -122.067683 },
    { name: "Family Housing Lot 136", lat: 36.99258, lng: -122.067582 },

    { name: "Kresge Lot 142", lat: 36.99919, lng: -122.066422 },
    { name: "Kresge Lot 143", lat: 36.997061, lng: -122.067064 },
    { name: "Kresge Lot 145", lat: 36.997276, lng: -122.067244 },
    { name: "Kresge Lot 147", lat: 36.996812, lng: -122.065315 },

    { name: "West Parking Garage", lat: 36.999068, lng: -122.063678 },
    { name: "West Charging Station", lat: 36.999126, lng: -122.063343 },

    { name: "Jack Baskin Lot 157", lat: 36.999126, lng: -122.063343 },
    { name: "Jack Baskin Lot 138", lat: 37.000204, lng: -122.063897 },

    { name: "Thimann Lot 138", lat: 36.998152, lng: -122.062603 },

    { name: "Redwood Grove Lot 158", lat: 36.998293, lng: -122.064609 },
    { name: "Redwood Grove Lot 159", lat: 36.997111, lng: -122.063948 },

    { name: "Oakes Circle", lat: 36.990163, lng: -122.063304 },

    { name: "College 10 Lot 114", lat: 37.000129, lng: -122.058957 },
    { name: "164 JOHN R. LEWIS COLLEGE", lat: 37.000826, lng: -122.059137 },
    { name: "College 10 Lot 165", lat: 37.001753, lng: -122.059404 },
    { name: "College 10 Lot 165", lat: 37.001753, lng: -122.059404 },
    { name: "College 10 Lot 167", lat: 37.003277, lng: -122.058957 },

    { name: "College 9 Lot 166", lat: 37.001763, lng: -122.057817 },


];



function initMap() {
    map = new google.maps.Map(document.getElementById("map"), {
        zoom: 15,
        center: new google.maps.LatLng(36.995412, -122.060783),
        gestureHandling: 'greedy'
    });
	
	forecastMap = new google.maps.Map(document.getElementById("forecastMap"), {
        zoom: 14.5,
        center: new google.maps.LatLng(36.995412, -122.060783),
        gestureHandling: 'greedy'
    });

    for (let i = 0; i < colleges.length; i++) {
        let college = colleges[i];
        let marker = new google.maps.Marker({
            position: { lat: college.lat, lng: college.lng },
            map: map,
            title: college.name,
        });
        marker.addListener("click", function () {
            selectLocation(college.name); // Call a function to select the location
        });
        markers.push(marker);
    }
}

// New function to update the dropdown selection
function selectLocation(collegeName) {
    const selectElement = document.getElementById("collegeLocation");
    // Find the option with the matching value and select it
    for (let option of selectElement.options) {
        if (option.value === collegeName) {
            option.selected = true;
            break;
        }
    }
    // Trigger any change event associated with the selection if needed
    selectElement.dispatchEvent(new Event('change'));
}


function handleLocationError(browserHasGeolocation, pos) {
    alert(
        browserHasGeolocation
            ? "Error: The Geolocation service failed."
            : "Error: Your browser doesn't support geolocation."
    );
    map.setCenter(pos);
}


/*
function reportSighting(collegeName, markerPosition) {
    const confirmation = window.confirm(
        `Do you want to report a TAPS sighting at ${collegeName}?`
    );
    if (confirmation) {
        const userId = firebase.auth().currentUser.uid;
        db.collection("sightings").add({
            uid: userId,
            college: collegeName,
            timestamp: firebase.firestore.FieldValue.serverTimestamp(),
        });
        fetchSightings();
    }
}
*/



function reportSighting(collegeName) {
    // Store collegeName globally or in a way that submitCitation can access
    window.currentCollege = collegeName;

    // Show the form for entering the citation date and time
    document.getElementById('citationDateTimeForm').style.display = 'block';
}



function populateLocationDropdown() {
    const selectElement = document.getElementById("collegeLocation");
    colleges.forEach(college => {
        const option = document.createElement("option");
        option.value = college.name;
        option.textContent = college.name;
        selectElement.appendChild(option);
    });
}

// Call the function to populate the dropdown after defining it
populateLocationDropdown();





async function submitCitation() {
            const citationNumber = document.getElementById('citationNumber').value || "Unavailable";
            const licensePlate = document.getElementById('licensePlate').value || "Unavailable";
            const selectedCollegeName = document.getElementById('collegeLocation').value;
            const timeOccurredStr = document.getElementById('timeOccurred').value;

            const date = new Date(timeOccurredStr);
            const utcDate = new Date(date.getTime() - (date.getTimezoneOffset() * 60000));
            const formattedTimeOccurred = utcDate.toISOString().slice(0, 19) + 'Z';

            const postData = {
                citationNumber: citationNumber,
                licensePlate: licensePlate,
                locationOccurred: selectedCollegeName,
                timeOccurred: formattedTimeOccurred
            };

            try {
                const response = await fetch('https://taps-2-0.onrender.com/api/citations', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(postData)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                console.log("Citation submitted successfully to Heroku!");

                await db.collection("user-reported-citations").add({
                    citationNumber: citationNumber,
                    //college: selectedCollegeName,
                    //time: formattedTimeOccurred,
                    licensePlate: licensePlate // Include the license plate info
                });

                alert("Citation submitted successfully");
                console.log("Citation submitted successfully to Firebase!");
            } catch (error) {
                console.error("Error submitting citation:", error);
            }
        }

function days_dropdown(){
	
	/*
    let elem = document.getElementById("days_show");
    if(dropped){
        elem.style.display = "none";
    }else{
        elem.style.display = "block";
    }
    dropped = !dropped;
	
	*/
    
}







/*
function toggleSightings() {
    showingAll = !showingAll;
    displaySightings();
    document.querySelector("button").textContent = showingAll
        ? "Show less"
        : "Show more";
}
*/
























async function fetchSightings() {
    const response = await fetch('https://taps-2-0.onrender.com/api/citations?password=N@vy0114');
    try {
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        const data = await response.json();
        allSightings = data.map(sighting => ({
            college: sighting.locationOccurred || 'Unavailable',
            time_exact: sighting.timeOccurred || 'Unavailable',
            citationNumber: sighting.citationNumber || 'Unavailable',
            licensePlate: sighting.licensePlate || 'Unavailable'
        }));
        displaySightings();
        populatePredictionLocationDropdown();
        // If you use the chart, make sure this function is defined
    } catch (error) {
        console.error("Error fetching sightings:", error);
    }
}




function populatePredictionLocationDropdown() {
    const selectElement = document.getElementById("predictionLocation");
    selectElement.innerHTML = ''; // Clear existing options
    let uniqueColleges = new Set(allSightings.map(sighting => sighting.college)); // Get unique colleges

    uniqueColleges.forEach(college => {
        if (college !== 'Unavailable') { // Avoid adding 'Unavailable' as an option
            const option = document.createElement("option");
            option.value = college;
            option.textContent = college;
            selectElement.appendChild(option);
        }
    });
}










function prepareDataForGraph(selectedLocation) {
    const hoursArray = new Array(24).fill(0);
    allSightings.forEach(sighting => {
        if (sighting.college === selectedLocation && sighting.time_exact !== 'Unavailable') {
            const correctedTime = correctDateFormat(sighting.time_exact);
            const date = new Date(correctedTime);
            console.log(`Parsed Date: ${date} for corrected time: ${correctedTime}`); // Check parsed date
            const hour = date.getHours();
            console.log(`Hour Extracted: ${hour}`); // Check hour extraction
            if (!isNaN(hour)) {
                hoursArray[hour]++;
            }
        }
    });
    console.log("Data prepared for graph:", hoursArray); // Log the prepared data
    return hoursArray;
}



function plotGraph(data, selectedLocation) {
    const ctx = document.getElementById('hourlyCitationChart').getContext('2d');
    // Create labels shifted by 7 hours and format them in 12-hour time format
    const labels = Array.from({ length: 24 }, (_, i) => {
        let shiftedHour = (i + 7) % 24; // Calculate the shifted hour
        const amPm = shiftedHour >= 12 ? 'PM' : 'AM'; // Determine AM/PM
        shiftedHour = shiftedHour % 12 || 12; // Convert 24-hour time to 12-hour format
        return `${shiftedHour}:00 ${amPm}`; // Return formatted label
    });

    if (window.myBarChart) {
        window.myBarChart.destroy(); // Destroy existing chart instance if it exists
    }

    window.myBarChart = new Chart(ctx, {
        type: 'line', // Use a line chart
        data: {
            labels: labels,
            datasets: [{
                label: `Number of Citations at ${selectedLocation}`,
                data: data,
                backgroundColor: 'rgba(54, 162, 235, 0.2)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 5,
                tension: 0.4 // Smooth the line
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            },
            plugins: {
                title: {
                    display: true,
                    text: `Number of Citations at ${selectedLocation}`,
                    font: {
                        size:25  // Increase this value for larger text
                    }
                }
            }
        }
    });
}



// Call this function to populate the dropdown after defining it
populatePredictionLocationDropdown();
function calculatePrediction() {
    const selectedLocation = document.getElementById('predictionLocation').value;
    const selectedHour = parseInt(document.getElementById('predictionTime').value.split(':')[0], 10);
    console.log(`Selected Location: ${selectedLocation}`);
    console.log(`Selected Hour: ${selectedHour}`);
    
    const citationDataByHour = prepareDataForGraph(selectedLocation);

    if (citationDataByHour.every(item => item === 0)) {
        console.log("No citation data available for the selected hour and location.");
    } else {
        plotGraph(citationDataByHour, selectedLocation);
    }

    const citationsAtLocation = allSightings.filter(sighting => sighting.college === selectedLocation);
    console.log(`Total citations at ${selectedLocation}: ${citationsAtLocation.length}`);

    const citationsAtLocationAndTime = citationsAtLocation.filter(sighting => {
        const correctedDateStr = correctDateFormat(sighting.time_exact);
        const sightingTime = new Date(correctedDateStr);
        sightingTime.setHours(sightingTime.getHours() + 7); // Offset time by 7 hours for calculation
        console.log(`Adjusted Sighting Time: ${sightingTime}`);
        if (isNaN(sightingTime.getTime())) {
            console.log(`Invalid date detected: ${sighting.time_exact}, Citation #${sighting.citationNumber}`);
            return false;
        }
        return sightingTime.getHours() === selectedHour;
    });

    const countCitationsAtLocation = citationsAtLocation.length;
    const countCitationsAtLocationAndTime = citationsAtLocationAndTime.length;
    const percentChance = countCitationsAtLocation > 0 ? (countCitationsAtLocationAndTime / countCitationsAtLocation * 100).toFixed(2) : 0;

    console.log(`Citations at ${selectedLocation} for the selected hour (${selectedHour}:00): ${countCitationsAtLocationAndTime}`);
    console.log(`Your chances of getting a ticket are ${percentChance}%`);

    let resultsHtml = ``;
	//Total citations at ${selectedLocation}: ${countCitationsAtLocation}<br>`;
    //resultsHtml += `Citations at ${selectedLocation} for the selected hour (${selectedHour}:00): ${countCitationsAtLocationAndTime}<br>`;
    resultsHtml += ` <br><h1> Your chances of getting a ticket are <b>${percentChance}%</b></h1>`;

    if (citationsAtLocation.length > 0) {
        resultsHtml += "<ul>";
        citationsAtLocation.forEach(sighting => {
            const correctedDateStr = correctDateFormat(sighting.time_exact);
            const sightingTime = new Date(correctedDateStr);
            if (!isNaN(sightingTime.getTime())) {
                sightingTime.setHours(sightingTime.getHours() + 7); // Offset time by 7 hours for display
                //resultsHtml += `<li>${sighting.college}: Citation #${sighting.citationNumber} - ${sightingTime.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true })}</li>`;
            } else {
                //resultsHtml += `<li>${sighting.college}: Citation #${sighting.citationNumber} - Invalid date format</li>`;
            }
        });
        resultsHtml += "</ul>";
    } else {
        resultsHtml += "No citations have been recorded at this location.";
    }

    document.getElementById('predictionResult').innerHTML = resultsHtml;
}

function correctDateFormat(dateStr) {
    let parts = dateStr.split('T');
    if (parts.length < 2) {
        return dateStr;
    }
    let dateParts = parts[0].split('-');
    if (dateParts[1] > 12) {
        let temp = dateParts[1];
        dateParts[1] = dateParts[2];
        dateParts[2] = temp;
    }
    dateParts = dateParts.map(part => part.padStart(2, '0'));
    let correctedDateStr = `${dateParts.join('-')}T${parts[1]}`;
    return correctedDateStr;
}












// Initialize prediction locations dropdown (you could reuse populateLocationDropdown() or create a similar function for the prediction dropdown)
populateLocationDropdown();






// Global variable to keep track of markers
var sightingMarkers = [];

// Global variable to keep track of whether we are showing all sightings or just the most recent 3
var showingAllSightings = false;




function displaySightings() {
    const container = document.getElementById("sightingsContainer");
    container.innerHTML = ""; // Clear the container

    sightingMarkers.forEach(marker => marker.setMap(null));
    sightingMarkers = [];

    if (allSightings.length === 0) {
        container.innerHTML = '<div class="item">No Data Available</div>';
        return;
    }

    // Sort allSightings by timeOccurred from newest to oldest
    allSightings.sort((a, b) => b.time_exact.localeCompare(a.time_exact));

    const sightingsToShow = showingAllSightings ? allSightings : allSightings.slice(0, 5);

    sightingsToShow.forEach(sighting => {
        let div = document.createElement("div");
        div.className = "item";

        // Manually parse and format the ISO date string
        const sightingDateTime = sighting.time_exact;
        const [datePart, timePart] = sightingDateTime.split('T');
        const [year, month, day] = datePart.split('-').map(num => parseInt(num, 10));
        let [hour, minute] = timePart.substring(0, 5).split(':').map(num => parseInt(num, 10));

        const ampm = hour >= 12 ? 'pm' : 'am';
        hour = hour % 12 || 12; // Convert 24h to 12h format and handle midnight

        const formattedDate = `${month}/${day}/${year}`;
        const formattedTime = `${hour}:${minute < 10 ? '0' : ''}${minute}${ampm}`;

        div.innerHTML = `
            <center>
            <div class="sighting-location">${sighting.college}</div>
            <div>${formattedDate}</div>
            <div>${formattedTime}</div>
            <div>Citation #: ${sighting.citationNumber}</div>
        `;
        container.appendChild(div);

        const college = colleges.find(college => college.name === sighting.college);
        if (college) {
            const marker = new google.maps.Marker({
                position: { lat: college.lat, lng: college.lng },
                map: forecastMap,
                title: `${sighting.college}: Citation #${sighting.citationNumber}`
            });
            sightingMarkers.push(marker);
        }
    });
    calculatePrediction();
    document.getElementById("toggleSightingsButton").textContent = showingAllSightings ? "Show Less" : "Show More";
}


function toggleSightingsDisplay() {
    showingAllSightings = !showingAllSightings;
    displaySightings();
}





function rad(x) {return x*Math.PI/180;}

function findNearby(position){
    let smallest = [];
    var lat = position.coords.latitude;
    var lng = position.coords.longitude;
    var R = 6371; // radius of earth in km
    var distances = [];
    var closest = -1;
    for( i=0;i<colleges.length; i++ ) {
        var mlat = colleges[i].lat;
        var mlng = colleges[i].lng;
        var dLat  = rad(mlat - lat);
        var dLong = rad(mlng - lng);
        var a = Math.sin(dLat/2) * Math.sin(dLat/2) +
            Math.cos(rad(lat)) * Math.cos(rad(lat)) * Math.sin(dLong/2) * Math.sin(dLong/2);
        var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
        var d = R * c;
        distances[i] = d;
        smallest[i]= {d: d, obj: colleges[i]};
        if ( closest == -1 || d < distances[closest] ) {
            closest = i;
        }
    }
    smallest.sort((a,b) => a.d - b.d);
    console.log(smallest);
    displayLocation(smallest);
}


function displayLocation(smallest){
    
		
		
		
    for (let i = 0; i < 5; i++){
		
		if(i == 0){
		var para = document.createElement("p");
		var node = document.createTextNode("Pick A Location Near You");
		para.appendChild(node);
		var element = document.getElementById("locations");
		element.appendChild(para);

		var para = document.createElement("br");
		var element = document.getElementById("locations");
		element.appendChild(para);
		
		}
		
		//if(i == 1){
		let div = document.createElement("div");
        div.className = "item";
        div.addEventListener('click',function(){
            reportSighting(smallest[i].obj.name);
         });
        div.innerHTML = `<div class="sighting-location">${smallest[i].obj.name}</div>`;
        document.getElementById("locations").appendChild(div);
		//}
        
		
		
	
	
		
    }
}
function error(errorObj){
    alert(errorObj.code + ": " + errorObj.message); 
    let div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `<div class="sighting-location">Geolocation not supportet</div>`;
    document.getElementById("locations").appendChild(div);
}
function currentLocation(){
    document.getElementById("locations").innerHTML="";
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(findNearby,error,{enableHighAccuracy: true, maximumAge: 10000});
      } else {
        let div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `<div class="sighting-location">Geolocation not supportet</div>`;
        document.getElementById("locations").appendChild(div);
      }
}

fetchSightings();	
	
	
	</script>
	
	<script src="./defundtaps.web.app_files/js" async="" defer=""></script>
	
  



</body></html>